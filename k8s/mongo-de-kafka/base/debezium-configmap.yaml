apiVersion: v1
kind: ConfigMap
metadata:
  name: debezium-config
data:
  application.properties: |
    # Debezium Server Configuration for MongoDB CDC to Kafka

    # Source: MongoDB
    debezium.source.connector.class=io.debezium.connector.mongodb.MongoDbConnector
    debezium.source.mongodb.connection.string=mongodb://mongodb-0.mongodb-headless.meshobj-examples-events.svc.cluster.local:27017,mongodb-1.mongodb-headless.meshobj-examples-events.svc.cluster.local:27017/?replicaSet=rs0
    debezium.source.topic.prefix=events
    debezium.source.database.include.list=events_development
    debezium.source.collection.include.list=events_development.event,events_development.processedevent

    # Change stream configuration
    debezium.source.capture.mode=change_streams
    debezium.source.mongodb.change.stream.full.document=updateLookup
    debezium.source.publish.full.document.only=true
    debezium.source.snapshot.mode=never

    # Sink: Kafka (Redpanda)
    debezium.sink.type=kafka
    debezium.sink.kafka.producer.bootstrap.servers=redpanda-0.redpanda-headless.meshobj-examples-events.svc.cluster.local:9092
    debezium.sink.kafka.producer.key.serializer=org.apache.kafka.common.serialization.StringSerializer
    debezium.sink.kafka.producer.value.serializer=org.apache.kafka.common.serialization.StringSerializer

    # Offset storage (file-based for dev)
    debezium.source.offset.storage.file.filename=/debezium/data/offsets.dat
    debezium.source.offset.flush.interval.ms=60000

    # Logging
    quarkus.log.console.enable=true
    quarkus.log.console.level=INFO
    quarkus.log.category."io.debezium".level=INFO
